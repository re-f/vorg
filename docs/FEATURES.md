# VOrg 功能特性详解

## 🔄 实时预览系统

### 核心特性
- **即时渲染**：文档内容变化时自动更新预览，无需手动刷新
- **双向同步**：编辑器与预览窗口完美同步，支持并排编辑模式
- **智能缓存**：优化渲染性能，确保大文档也能流畅预览

### 预览模式

#### 标准预览模式
- 在当前标签页中打开预览
- 适合单屏幕或专注模式使用
- 快捷键：`Ctrl+Shift+V` (Windows/Linux) 或 `Cmd+Shift+V` (Mac)

#### 并排预览模式 ⭐
- 编辑器和预览窗口并排显示
- 真正的实时编辑体验
- 快捷键：`Ctrl+K V` (Windows/Linux) 或 `Cmd+K V` (Mac)

## 🔄 精准滚动同步

- **实时位置跟踪**：编辑器滚动时预览窗口自动同步
- **平滑滚动动画**：提供流畅的视觉体验
- **滚动进度指示器**：顶部蓝色进度条显示当前滚动位置
- **智能定位算法**：基于行号百分比精确计算滚动位置

## 🎨 智能主题适配

- **自动主题检测**：根据 VS Code 当前主题自动调整预览样式
- **明暗模式支持**：完美适配 Light/Dark/High Contrast 主题
- **专业排版**：采用现代化的字体和排版设计
- **响应式布局**：自适应不同屏幕尺寸和窗口大小

## 📝 完整的 Org-mode 语法支持

### 基础格式
- **标题层级**：支持 1-6 级标题 (`*` 到 `******`)
- **文本格式**：粗体、斜体、下划线、代码、等宽字体
- **列表系统**：无序列表、有序列表、任务列表、多级嵌套
- **链接系统**：外部链接、内部链接

### 高级功能
- **代码块**：支持语法高亮的代码块
- **表格渲染**：完整的表格支持
- **引用块**：美观的引用块渲染
- **元数据支持**：文档属性、关键字、标签系统

## 📋 文档大纲导航 ⭐

### 智能结构解析
- **多级标题识别**：自动识别 1-6 级标题层级 (`*` 到 `******`)
- **标签提取**：解析并显示标题标签（如 `:tag1:tag2:`）
- **文档属性**：识别重要的文档元数据（TITLE、AUTHOR、DATE、EMAIL）
- **层级结构**：构建完整的文档树状结构

## 📁 智能代码折叠 ⭐

### 标题级别折叠
- **层级折叠**：根据 Org-mode 标题层级自动创建折叠区域
- **点击折叠**：点击标题左侧的折叠图标即可折叠/展开内容
- **嵌套折叠**：支持多级标题的嵌套折叠，方便管理复杂文档结构
- **智能边界**：自动识别标题内容边界，精确定位折叠范围

### 代码块折叠
- **代码块支持**：支持 `#+BEGIN_SRC`/`#+END_SRC` 代码块的折叠
- **引用块支持**：支持 `#+BEGIN_QUOTE`/`#+END_QUOTE` 引用块的折叠
- **示例块支持**：支持 `#+BEGIN_EXAMPLE`/`#+END_EXAMPLE` 示例块的折叠
- **Property 抽屉支持**：支持 `:PROPERTIES:`/`:END:` Property 抽屉的折叠

### 使用方法
- **键盘快捷键**：
  - `Ctrl+Shift+[` (Windows/Linux) 或 `Cmd+Option+[` (Mac) - 折叠当前区域
  - `Ctrl+Shift+]` (Windows/Linux) 或 `Cmd+Option+]` (Mac) - 展开当前区域
  - `Ctrl+K Ctrl+0` (Windows/Linux) 或 `Cmd+K Cmd+0` (Mac) - 折叠所有区域
  - `Ctrl+K Ctrl+J` (Windows/Linux) 或 `Cmd+K Cmd+J` (Mac) - 展开所有区域
- **鼠标操作**：点击行号左侧的折叠图标 (▼/▶)
- **右键菜单**：在标题行右键选择"折叠"或"展开"选项

### 适用场景
- **长文档管理**：折叠不相关的章节，专注于当前编辑内容
- **文档概览**：折叠详细内容，查看文档整体结构
- **演示准备**：逐步展开内容，适合演示或教学场景
- **代码审查**：折叠已确认的代码块，专注于需要审查的部分

### 导航功能
- **Outline 面板**：在 VS Code 侧边栏的 Outline 面板中显示文档结构
- **快速跳转**：点击大纲项目快速跳转到对应位置
- **符号搜索**：使用 `Ctrl+Shift+O` (Windows/Linux) 或 `Cmd+Shift+O` (Mac) 搜索跳转
- **面包屑导航**：在编辑器顶部显示当前位置的层级路径

### 符号类型映射
- **一级标题** (`*`) → 📁 Module 图标
- **二级标题** (`**`) → 📂 Class 图标  
- **三级标题** (`***`) → 🔧 Method 图标
- **四级及以上标题** → 🏷️ Property 图标
- **文档属性** → 📌 Constant 图标

### 使用场景
- **长文档导航**：快速定位到文档的特定部分
- **结构预览**：一眼了解文档的整体结构和组织方式
- **编辑辅助**：在编辑过程中快速在不同章节间跳转
- **文档审查**：检查文档结构的完整性和逻辑性

## 🚀 用户体验设计

### 智能错误处理
- **文件类型检测**：自动识别非 Org 文件并显示友好提示
- **语法错误处理**：解析错误时显示详细错误信息
- **空文件处理**：优雅处理空文档或无效内容

### 性能优化
- **增量更新**：只重新渲染变化的部分
- **内存管理**：智能清理未使用的预览窗口
- **渲染缓存**：避免重复计算，提升大文档性能
- **大纲缓存**：智能缓存文档结构，避免重复解析

## 🏷️ Property 属性管理 ⭐

### 核心功能
- **智能属性设置**：类似 Emacs `org-set-property` 的完整实现
- **自动抽屉管理**：智能创建和管理 Property 抽屉
- **属性更新**：支持添加、更新、删除属性
- **缩进对齐**：自动保持属性缩进的一致性

### 使用方法

#### 设置属性
1. **快捷键**：`Ctrl+C Ctrl+X P` (类似 Emacs `C-c C-x p`)
2. **命令面板**：`VOrg: Set Property`
3. **操作流程**：
   - 将光标放在标题或其内容区域
   - 执行设置属性命令
   - 输入属性名（如：CATEGORY, PRIORITY, CREATED）
   - 输入属性值（如：work, high, [2023-10-20]）

#### 智能行为
- **新标题**：自动创建 Property 抽屉并添加属性
- **已有抽屉**：
  - 属性存在 → 更新其值
  - 属性不存在 → 在 `:END:` 前添加新属性
- **缩进对齐**：新属性自动与现有属性保持一致的缩进

#### Property 抽屉格式
```org
* 标题
  :PROPERTIES:
  :CATEGORY: work
  :PRIORITY: high
  :CREATED: [2023-10-20]
  :END:
```

### 智能编辑支持

#### 在 Property 抽屉内编辑
- **Alt+Enter**：在 Property 抽屉内插入新的属性行
- **自动缩进**：新属性行自动与现有属性保持缩进一致
- **上下文识别**：系统自动识别 Property 抽屉上下文

#### 支持的上下文类型
- `property-drawer`：Property 抽屉内部
- `property-drawer-header`：`:PROPERTIES:` 行
- `property-drawer-end`：`:END:` 行
- `property-item`：具体属性行

## 📊 标题操作功能 ⭐

### 核心功能
- **升级子树**：类似 Emacs `org-promote-subtree`，减少整个子树的标题级别
- **降级子树**：类似 Emacs `org-demote-subtree`，增加整个子树的标题级别
- **智能操作**：自动识别子树范围，保持相对层级关系

### 使用方法

#### 快捷键操作
- **升级子树**：`Ctrl+C Ctrl+Shift+,` (类似 Emacs `C-c C-<`)
- **降级子树**：`Ctrl+C Ctrl+Shift+.` (类似 Emacs `C-c C->`)

#### CodeLens 按钮操作
- 在标题行上方显示操作按钮（需启用 `vorg.showCodeLens` 配置）
- **Promote 按钮**：仅在 2 级及以上标题显示
- **Demote 按钮**：所有标题都显示
- 点击按钮即可快速执行操作

#### 命令面板操作
- `VOrg: Promote Subtree` - 升级子树
- `VOrg: Demote Subtree` - 降级子树

### 操作行为
- **升级子树**：
  - 将整个子树的所有标题级别减少 1
  - 1 级标题不能再升级（已是最低级别）
  - 保持子树内各标题的相对层级关系
  
- **降级子树**：
  - 将整个子树的所有标题级别增加 1
  - 保持子树内各标题的相对层级关系

### 配置选项
- `vorg.showCodeLens`：控制是否显示 CodeLens 操作按钮（默认：`true`）

### 使用示例

**升级前：**
```org
* 一级标题
** 二级标题
*** 三级标题
** 另一个二级标题
```

**升级后（光标在一级标题上执行升级）：**
```org
* 一级标题
* 二级标题
** 三级标题
* 另一个二级标题
```

**降级后（光标在一级标题上执行降级）：**
```org
** 一级标题
*** 二级标题
**** 三级标题
*** 另一个二级标题
```

## 🔗 自动补全功能 ⭐

### ID 链接补全
- **触发方式**：输入 `[[` 或 `[[id:` 自动触发
- **补全内容**：显示工作区中所有 org 文件的标题
- **搜索过滤**：在 `[[id:` 后输入部分标题文本进行过滤
- **自动处理**：选择后自动插入 `[[id:UUID][标题]]` 格式，如标题无 ID 则自动生成
